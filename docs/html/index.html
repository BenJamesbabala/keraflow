<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Keraflow: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Keraflow
   </div>
   <div id="projectbrief">Deep Learning for Python.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Keraflow Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Why Keraflow</h2>
<blockquote class="doxtable">
<p>Keras is a minimalist, highly modular neural networks library, written in Python and capable of running on top of either <a href="https://github.com/tensorflow/tensorflow">TensorFlow</a> or <a href="https://github.com/Theano/Theano">Theano</a>. It was developed with a focus on enabling fast experimentation. Being able to go from idea to result with the least possible delay is key to doing good research.</p>
<p></p>
</blockquote>
<p>As its official description, <a href="https://github.com/fchollet/keras">Keras</a> serves as an excellent front-end for graph based deep learning framework. However, from the point of view of soft-engineering, its API design and its complicated internal mechanism makes it hard to understand and cumbersome to extend. Therefore, I reimplement the core of Keras to provide:</p>
<ol type="1">
<li>An simpler tensor linkage mechanism for developers to understand it.</li>
<li>A cleaner and more consistent API for user to use and extend it.</li>
<li>Some extra functionality not implemented in Keras.</li>
</ol>
<p>For the full API reference, read the <a href="https://ipod825.github.io/keraflow/doc/html/index.html">online documentation</a>. It is strongly recommended to read the <a href="https://ipod825.github.io/keraflow/doc/html/md_Tutorials.html">Tutorials</a> first to know the basics on building neural network models with Keraflow. </p>
<hr/>
 <h2>Features</h2>
<h3>Keras-like</h3>
<ul>
<li>Uses both theano and tensorflow as backend.</li>
<li>Provides various layers including convolution layers and recurrent layers.</li>
<li>Decoupled regularizer, constraint, layer, optimizer... modules.</li>
<li>Supports arbitrary connectivity schemes (including multi-input and multi-output training).</li>
</ul>
<h3>New Features</h3>
<ul>
<li>A simpler tensor linkage mechnism.</li>
<li>An easier way of writing custmoized layers<ul>
<li>No <code>initial_weights</code>, <code>regularizers</code>, <code>constraints</code> arguments for layers' <code>__init__</code>.</li>
<li>No <code>get_config</code> for layers' serialization.</li>
<li>Existing layer are reusable to build new layers with the magic <b>embed</b> function.</li>
</ul>
</li>
</ul>
<p>For more details about the difference between Keraflow and Keras, please refer to the <a href="#differences-from-keras">Differences from Keras</a>. </p>
<hr/>
<h2>Installation</h2>
<p>Keraflow uses the following dependencies:</p>
<ul>
<li>numpy, scipy, tqdm</li>
<li>pyyaml, hickle (optional, required if you use model saving/loading functions)</li>
<li>Optional but recommended if you use CNNs: cuDNN.</li>
</ul>
<p><em>When using the Theano backend:</em></p>
<ul>
<li>Theano<ul>
<li><a href="http://deeplearning.net/software/theano/install.html#install">See installation instructions</a>.</li>
</ul>
</li>
</ul>
<p><em>When using the TensorFlow backend:</em></p>
<ul>
<li>TensorFlow<ul>
<li><a href="https://github.com/tensorflow/tensorflow#download-and-setup">See installation instructions</a>.</li>
</ul>
</li>
</ul>
<p>To install Keraflow, <code>cd</code> to the Keraflow folder and run the install command: </p>
<div class="fragment"><div class="line">$ sudo python setup.py install</div>
</div><!-- fragment --><p>You can also install Keraflow from PyPI: </p>
<div class="fragment"><div class="line">$ sudo pip install keraflow</div>
</div><!-- fragment --> <hr/>
 <h2>Contributing</h2>
<h3>Environment Setting</h3>
<p>To make Keraflow compatible with both python2 &amp; python3. We use <a href="https://github.com/yyuu/pyenv">pyenv</a> to build virtual environment. The shell script <code>dev_scrips/install_dependency.sh</code> could quickly sets up the testing environments. </p>
<div class="fragment"><div class="line"><span class="preprocessor"># In project root directory (parent directory  of `dev_scripts`)</span></div>
<div class="line"><span class="preprocessor"></span>$ bash dev_scrips/install_dependency.sh</div>
<div class="line"><span class="preprocessor"># Two pyenv environment k2, k3 are installed now.</span></div>
</div><!-- fragment --><p><b>Note</b>: The script does not add pyenv PATH in your script config file (e.g. ~/.zshrc). You will need to manually copy and paste the following into your shell config file so that the next time you log in, pyenv will be in the PATH:</p>
<div class="fragment"><div class="line">export PATH=<span class="stringliteral">&quot;$HOME/.pyenv/bin:$PATH&quot;</span></div>
<div class="line">eval <span class="stringliteral">&quot;$(pyenv init -)&quot;</span></div>
<div class="line">eval <span class="stringliteral">&quot;$(pyenv virtualenv-init -)&quot;</span></div>
</div><!-- fragment --><p>To quickly modify and run tests. Run: </p>
<div class="fragment"><div class="line">$ python setup.py develop  # will link the project root into k2<span class="stringliteral">&#39;s site package directory</span></div>
</div><!-- fragment --><p>And then run tests via <code>dev_scripts/run_test.sh</code>. Run: </p>
<div class="fragment"><div class="line"><span class="preprocessor"># In project root directory (parent directory  of `dev_scripts`)</span></div>
<div class="line"><span class="preprocessor">$ bash dev_scripts/run_test.sh</span></div>
</div><!-- fragment --><p><code>dev_scripts/run_test.sh</code> checks pep8, python2 testing and python3 testing. You could also run tests manually: </p>
<div class="fragment"><div class="line">$ pyenv activate k2 # python2 environment <span class="keywordflow">for</span> testing keraflow</div>
<div class="line">$ py.test tests  # run tests in tests/ directory</div>
<div class="line">$ pyenv activate k3 # python3 environment <span class="keywordflow">for</span> testing keraflow</div>
<div class="line">$ py.test tests  # run tests in tests/ directory</div>
</div><!-- fragment --><h3>PEP8</h3>
<p><code>dev_scripts/run_test.sh</code> checks pep8, it you fail on syntax check, you could use <code>autopep8</code> to fix it: </p>
<div class="fragment"><div class="line">$ pip install autopep8</div>
<div class="line">$ autopep8 --recursive -i --select E128 keraflow  # fix all error no.128</div>
</div><!-- fragment --><p>It is highly recommend you avoid these errors when writing them using some editor plugins. If you use vim (or neovim), I recommend installing <code>flake8</code> and adopt the settings in this <a href="https://gist.github.com/ipod825/fbee70d8bd063f228951cd4b6f38f4df">gist</a>. Note that <code>flask8</code> is required: </p>
<div class="fragment"><div class="line">$ pip install flask8</div>
</div><!-- fragment --><h3>Documentation</h3>
<ol type="1">
<li>Documentation uses <a href="https://www.stack.nl/~dimitri/doxygen/manual/docblocks.html">doxygen</a>.</li>
<li>Follow the convention to use <code>@</code> for special commands (<code>param</code>, <code>package</code>... etc.)</li>
<li>Installation <div class="fragment"><div class="line">$ sudo apt-<span class="keyword">get</span> install doxygen</div>
<div class="line">$ sudo pip install doxypy</div>
</div><!-- fragment --></li>
<li>Documentation generation <div class="fragment"><div class="line">$ cd doc</div>
<div class="line">$ doxygen Doxyfile</div>
<div class="line"><span class="preprocessor"># open ./html/index.html with web browser</span></div>
</div><!-- fragment --> <hr/>
</li>
</ol>
<h2>Differences from Keras</h2>
<h3>A simpler tensor linkage mechanism</h3>
<p>Two main things that makes Keras complicated:</p>
<ol type="1">
<li>Keras determines layer input shape by back-tracing from output tensors to input tensors, which makes its tensor linkage process a recursive process.</li>
<li>Keras keeps track of tensor linkage by keeping two lists <code>inbound_nodes</code> and <code>outbound_nodes</code> in each layer. However, maintaining a list to keep track of linkage is usually a brain-killing job.</li>
</ol>
<p>Keraflow, intead</p>
<ol type="1">
<li>Flows information (tensors and their shapes) from inputs to outputs, making tensor linkage a sequential process (well, at least <code>a+b+c+d</code> is more amiable than <code>(a+(b+(c+d)))</code>).</li>
<li>Uses only a list to keep track of tensor linkage, which is actually unnecessary if serilization is not a concern.</li>
</ol>
<h3>An easier way of writing custmoized layers</h3>
<h4>Less arguments for layers' <code>__init__</code></h4>
<p>Check the constructor of <b>Dense</b> layer:</p>
<p><b>Keras</b> </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">def </span>__init__(self, output_dim, init=&#39;glorot_uniform&#39;, activation=&#39;linear&#39;, weights=None, W_regularizer=None, b_regularizer=None, activity_regularizer=None, W_constraint=None, b_constraint=None, bias=True, input_dim=None, **kwargs):</div>
</div><!-- fragment --><p><b>Keraflow</b> </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">def</span> __init__(self, output_dim, init=<span class="stringliteral">&#39;glorot_uniform&#39;</span>, activation=<span class="stringliteral">&#39;linear&#39;</span>, bias=<span class="keyword">True</span>, **kwargs):</div>
</div><!-- fragment --><p>The signal of <code>initial weights</code>, <code>regularizers</code>, and <code>constraints</code> disappear since Keraflow takes care of them in <b>Layer</b> class. The signal of input dimension also disappears since Keraflow force users to specify an <b>Input</b> layer and their shape for all models.</p>
<p>When creating a customized layer, users no longer need to write <code>regularizers</code>, <code>constraints</code> initialization code for the layer. Special care for the input dimension is also unnecessary.</p>
<p>One additional merit of abstracting <code>initial_weights</code>, <code>regularizers</code>, <code>constraints</code> initialization process in <b>Layer</b> class is that Keraflow easily (without adding too much code) enables users to initialize those of a layer with dictionary:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;dense = Dense(64, initial_weights={<span class="stringliteral">&#39;W&#39;</span>: W, <span class="stringliteral">&#39;b&#39;</span>:b},</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;              regularizers={<span class="stringliteral">&#39;W&#39;</span>: <span class="stringliteral">&#39;l1&#39;</span>, <span class="stringliteral">&#39;b&#39;</span>:<span class="stringliteral">&#39;l2&#39;</span>},</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;              constraints={<span class="stringliteral">&#39;W&#39;</span>: <span class="stringliteral">&#39;maxnorm&#39;</span>, <span class="stringliteral">&#39;b&#39;</span>:<span class="stringliteral">&#39;unitnorm&#39;</span>})</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;dense = Dense(64, initial_weights=[W, b],</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;              regularizers=[<span class="stringliteral">&#39;l1&#39;</span>, <span class="stringliteral">&#39;l2&#39;</span>],</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;              constraints=[<span class="stringliteral">&#39;maxnorm&#39;</span>, <span class="stringliteral">&#39;unitnorm&#39;</span>])</div>
</div><!-- fragment --><h4>No <code>get_config</code> for serialization.</h4>
<p>Every layer in Keras has a <code>get_config</code> function, which is needed for serializing models. Though its implementation is not necessary for customized layers, it would be good for developers to save the time implementing it just for serializing their models.</p>
<p>Keraflow takes care of this, every layer that fulfils some <a href="https://ipod825.github.io/keraflow/doc/html/md_Developer-Guide.html#serialization_mechanism">constraints</a> is naturally seizable.</p>
<h4>Embed existing layers to write new layers</h4>
<p>Currently, in Keras, when writing you own layers, even if you want to conduct similar operation of the <code>Dense</code> layer, you still need to define some trainable parameters (write initialization code and add it to the layer's trainable parameters list) for that.</p>
<p>In Keraflow, you could simply write (in <code>output</code> function, the correspondence of <code>get_output_for</code> in Keras): </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;self.embed(Dense(output_dim))(input_tensor)</div>
</div><!-- fragment --><p>Everything is done!! The parameters of <code>Dense</code> is automatically added as parameters of your layer and is updated during training. For more information, see <a href="https://ipod825.github.io/keraflow/doc/html/md_Developer-Guide.html#layer_embedding">Layer Embedding</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Sep 5 2016 15:54:50 for Keraflow by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
