<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Keraflow: Tutorials</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Keraflow
   </div>
   <div id="projectbrief">Deep Learning for Python.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_Tutorials.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Tutorials </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#an_over_view_of_layer">An Overview of Layer</a><ul><li class="level2"><a href="#layer_initialization">Layer Initialization</a></li>
<li class="level2"><a href="#shared_layer">Shared Layer</a></li>
<li class="level2"><a href="#mulriple_inputs_to_a_layer">Multiple Inputs to a Layer</a></li>
<li class="level2"><a href="#anonymous_layers">Anonymous Layers (Sequential)</a></li>
</ul>
</li>
<li class="level1"><a href="#an_over_view_of_model">An Overview of Model</a><ul><li class="level2"><a href="#constructing_the_model">Constructing the Model</a></li>
<li class="level2"><a href="#configuring_loss_and_optimizing_rule">Configuring Loss and Optimizing Rule</a></li>
<li class="level2"><a href="#train_evaluate_predict">Train/Evaluate/Predict</a></li>
<li class="level2"><a href="#model_serialization">Model Serialization</a></li>
</ul>
</li>
<li class="level1"><a href="#argument_passing_summarization">Argument Passing Summarization</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="an_over_view_of_layer"></a>
An Overview of Layer</h1>
<blockquote class="doxtable">
<p>A Layer is a one-to-one or many-to-one tensor transformer</p>
<p></p>
</blockquote>
<p>Both theano and tensorflow are graph based deep learning framework. Let <code>X</code>, <code>W</code> and <code>b</code> be three symbolic tensors. Then <code>Y=WX+b</code> makes <code>Y</code> a new symbolic tensor that equals to <code>W</code> dots <code>X</code> plus <code>b</code>. When there are many tensors in your model, things get messy. The purpose of <a class="el" href="classkeraflow_1_1layers_1_1base_1_1Layer.html">Layer</a> is to simplify the process of building new tensors from existing tensors. For example:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;from <a class="code" href="namespacekeraflow_1_1layers.html">keraflow.layers</a> <span class="keyword">import</span> Input, Dense</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;X = Input(shape=(100,))</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;dense_layer = Dense(output_dim=64, init=<span class="stringliteral">&#39;unitorm&#39;</span>, activation=<span class="stringliteral">&#39;linear&#39;</span>)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Y = dense_layer(X)  <span class="comment"># Y=WX+b</span></div>
</div><!-- fragment --><p>In Keraflow, an <a class="el" href="classkeraflow_1_1layers_1_1base_1_1Input.html">Input</a> layer (line 1) is a special type of layer that could be treated as a symbolic tensor. By feeding a tensor <code>X</code> to a layer (line 4), we got a new symbolic tensor <code>Y</code>, which can then be fed to another layer.</p>
<h2><a class="anchor" id="layer_initialization"></a>
Layer Initialization</h2>
<p>Each layer takes different arguments to initialize. As seen above, a dense layer takes three argument. However, there are some common key word arguments you could pass to every layer, which are defined in Layers' <a class="el" href="classkeraflow_1_1layers_1_1base_1_1Layer.html#aa5f88487e05503f9488b35156c993c42">__init__</a>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">class </span>Layer(object):</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    <span class="keyword">def </span>__init__(self, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;                 name=<span class="keywordtype">None</span>,</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;                 trainable=<span class="keyword">True</span>,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;                 initial_weights=<span class="keywordtype">None</span>,</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;                 regularizers=<span class="keywordtype">None</span>,</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;                 constraints=<span class="keywordtype">None</span>):</div>
</div><!-- fragment --><ol type="1">
<li>Set <code>name</code> for easy debugging.</li>
<li>Set <code>trainable</code> to False, if you don't want the layer parameters be updated during training process.</li>
<li>Set <code>initial_weights</code> to directly assign the initial values of the layer parameters (this will override the <code>init</code> argument). See <a class="el" href="md_Initializations.html">Initializations</a>.</li>
<li>Set <code>regularizers</code> to apply regularization penalty on the layer parameters. See <a class="el" href="md_Regularizers.html">Regularizers</a>.</li>
<li>Set <code>constraints</code> to restrict the value of layer parameters when updating them during training process. See <a class="el" href="md_Constraints.html">Constraints</a>.</li>
</ol>
<p>For details on setting <code>initial_weights</code>, <code>regularizers</code>, and <code>constraints</code>, please see <a class="el" href="md_Tutorials.html#argument_passing_summarization">Argument Passing Summarization</a> and the related pages.</p>
<h2><a class="anchor" id="shared_layer"></a>
Shared Layer</h2>
<p>A layer can be fed multiple times by different input tensors. Considering the following case: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment"># symbolic tensor</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Y1=WA+b</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Y2=WB+b</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"># Keraflow equivalent</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"># X1, X2 should be of the same shape</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;A = Input(100)</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;B = Input(100)</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;d = Dense(50)</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Y1 = d(A)</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Y2 = d(B)</div>
</div><!-- fragment --><p>By feeding the same layer two times, we keep only one <code>W</code> and <code>b</code> in our tensor graph.</p>
<h2><a class="anchor" id="mulriple_inputs_to_a_layer"></a>
Multiple Inputs to a Layer</h2>
<p>A layer might take more than one tensor as input. For example:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1layers.html">keraflow.layers</a> <span class="keyword">import</span> Input, Dense, Concatenate</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Y1 = Dense(50)(Input(100))</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Y2 = Dense(20)(Input(100))</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;concat = Concatenate(axis=0)([Y1, Y2)])  <span class="comment"># concat will be a tensor of dimension 70</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;output = Dense(2)(concat)</div>
</div><!-- fragment --><p>The only difference of a multiple input layer is that it takes a list of input tensors as input instead a single tensor. Users could define their own layers to take either single or multiple input tensors. See <a class="el" href="md_Developer-Guide.html#implementing_layer_functions">Implementing Layer Functions</a></p>
<h2><a class="anchor" id="anonymous_layers"></a>
Anonymous Layers (Sequential)</h2>
<p>We already see how to obtain a new tensor by feeding a tensor to a layer. However, it would be cumbersome to name all the tensors if we just want to perform a series of operation. <a class="el" href="classkeraflow_1_1models_1_1Sequential.html">Sequential</a> thus provides a syntax sugar for us:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1layers.html">keraflow.layers</a> <span class="keyword">import</span> Input, Dense, Activation</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1models.html">keraflow.models</a> <span class="keyword">import</span> Sequential</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;seq = Sequential()</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;seq.add(Input(100))  </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;seq.add(Dense(64))</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;seq.add(Dense(32))</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;seq.add(Activation(<span class="stringliteral">&#39;softmax&#39;</span>))</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"># Alternatively</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;seq = Sequential([Input(100), Dense(64), Dense(32), Activation(<span class="stringliteral">&#39;softmax&#39;</span>)])</div>
</div><!-- fragment --><p>Note that when the first layer of <code>Sequential</code> is an <code>Input</code> layer, it is treated as a tensor (the tensor output by the last layer), i.e. you could feed it to another layer but you can not feed other tensor to it. </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1layers.html">keraflow.layers</a> <span class="keyword">import</span> Input, Dense, Activation</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1models.html">keraflow.models</a> <span class="keyword">import</span> Sequential</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;seq = Sequential([Input(100), Dense(64), Dense(32), Activation(<span class="stringliteral">&#39;softmax&#39;</span>)])</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;output = Dense(2)(seq)</div>
</div><!-- fragment --><p>When the first layer of <code>Sequential</code> is not an <code>Input</code> layer, it is treated as a normal layer, whether it takes a single tensor or a list of tensors denpend on its first layer.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;seq = Sequential()</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;seq.add(Concatenate())  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;seq.add(Dense(64))</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;input1 = Input(100)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;input2 = Input(100)</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;output = seq([input1, input2])</div>
</div><!-- fragment --><p>We've cover what users need to know to use existing layers in Keraflow. For advanced information such as writing customized layer, please refer to <a class="el" href="md_Developer-Guide.html">Developer-Guide</a></p>
<h1><a class="anchor" id="an_over_view_of_model"></a>
An Overview of Model</h1>
<p>A typical deep learning model does the follows:</p>
<ol type="1">
<li>Derives the output tensor <code>Y</code> from the input tensor <code>X</code> such that <code>Y</code> = f(<code>X</code>), where f is the model with some trainable parameters (e.g. <code>Y</code>=<code>WX</code>+<code>b</code>).</li>
<li>Decides how far <code>Y</code> is from the gold answer <code>Target</code> according to a loss function: <code>loss</code> = L(<code>Y</code>, <code>Target</code>).</li>
<li>Calculates the gradient of <code>loss</code> with respect to the trainable parameters: <code>Gw</code>, <code>Gb</code> = grad(<code>loss</code>, <code>W</code>), grad(<code>loss</code>, <code>b</code>)</li>
<li>Minimizes <code>loss</code> according to some optimizing rule (e.g. subtracting the gradient from the parameters <code>W</code>, <code>b</code> = <code>W</code>-<code>GW</code>, <code>b</code>-<code>Gb</code>)</li>
</ol>
<p>We now introduce <a class="el" href="classkeraflow_1_1models_1_1Model.html">Model</a> and <a class="el" href="classkeraflow_1_1models_1_1Sequential.html">Sequential</a> to cover these steps.</p>
<h2><a class="anchor" id="constructing_the_model"></a>
Constructing the Model</h2>
<p>Let's start from the simple model with one input tensor: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1layers.html">keraflow.layers</a> <span class="keyword">import</span> Input, Dense</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1models.html">keraflow.models</a> <span class="keyword">import</span> Model</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;X = Input(100)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;M = Dense(50)(X)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Y = Dense(2, activation=<span class="stringliteral">&#39;softmax&#39;</span>)(M)</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;model = Model(inputs=X, outputs=Y)  </div>
</div><!-- fragment --><p>We tell the model that the input tensor is <code>X</code> and the output tensor is <code>Y</code>. In the one-input-one-output case, we could simply use <a class="el" href="classkeraflow_1_1models_1_1Sequential.html">Sequential</a> to avoid naming all the tensors.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1layers.html">keraflow.layers</a> <span class="keyword">import</span> Input, Dense</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1models.html">keraflow.models</a> <span class="keyword">import</span> Sequential</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;model = Sequential()</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;model.add(Input(100))</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;model.add(Dense(50))</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;model.add(Dense(2, activaion=<span class="stringliteral">&#39;softmax&#39;</span>))</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"># Alternatively </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;model = Sequential([Input(100), Dense(50), Dense(2, activation=<span class="stringliteral">&#39;softmax&#39;</span>)])</div>
</div><!-- fragment --><p>Note that <a class="el" href="classkeraflow_1_1models_1_1Sequential.html">Sequential</a> can only be used as a model (able to call <code>fit</code>, <code>predict</code>) when its first layer is an <a class="el" href="classkeraflow_1_1layers_1_1base_1_1Input.html">Input</a> layer. Moreover, if there are multiple input tensors or multiple output tensors, we could only use <code>Model</code>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1layers.html">keraflow.layers</a> <span class="keyword">import</span> Input, Dense</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">from</span> <a class="code" href="namespacekeraflow_1_1models.html">keraflow.models</a> <span class="keyword">import</span> Sequential, Model</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;X1 = Input(100)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Y1 = Dense(50, name=<span class="stringliteral">&#39;output1&#39;</span>)(X)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;X2 = Input(100)</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Y2 = Dense(50, name=<span class="stringliteral">&#39;output2&#39;</span>)(X)</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;model = Model(inputs=[X1, X2], outputs=[Y1, Y2])  </div>
</div><!-- fragment --><h2><a class="anchor" id="configuring_loss_and_optimizing_rule"></a>
Configuring Loss and Optimizing Rule</h2>
<p>Now we can specify the loss function and the optimizer. For single output model (including <a class="el" href="classkeraflow_1_1models_1_1Sequential.html">Sequential</a>): </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;model.compile(optimizer=<span class="stringliteral">&#39;sgd&#39;</span>, loss=<span class="stringliteral">&#39;categorical_crossentropy&#39;</span>)</div>
</div><!-- fragment --><p>For a model with multiple outputs, we need to specify a loss function for each output channel: </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;model.compile(optimizer=<span class="stringliteral">&#39;sgd&#39;</span>, loss={<span class="stringliteral">&#39;output1&#39;</span>:<span class="stringliteral">&#39;categorical_crossentropy&#39;</span>, <span class="stringliteral">&#39;output2&#39;</span>: <span class="stringliteral">&#39;mean_squared_error&#39;</span>})</div>
</div><!-- fragment --><p> Note that the name of each output channel is the name of the corresponding output layer (<code>output1</code>, <code>output2</code> in the example). If you feel that writing these names unnecessary, you could also pass a list to <code>loss</code> (see <a class="el" href="md_Objectives.html">Objectives</a>).</p>
<p>In the examples, we pass strings (e.g. <code>sgd</code>, <code>categorical_crossentropy</code>). These strings are actually alias of predefined optimizers and loss functions. You could also pass customized optimize/loss function instance (see <a class="el" href="md_Optimizers.html">Optimizers</a>, <a class="el" href="md_Objectives.html">Objectives</a>).</p>
<h2><a class="anchor" id="train_evaluate_predict"></a>
Train/Evaluate/Predict</h2>
<p>Both <a href="keraflow.models.Model">Model</a> and <a href="keraflow.models.Sequential">Sequential</a> has</p>
<ul>
<li><a class="el" href="classkeraflow_1_1models_1_1Model.html#aebe458039ef29e1d9b75ece6bdeec7b4">fit</a>: fitting <code>X</code> to <code>Target</code> by iteratively updating model parameters.</li>
<li><a class="el" href="classkeraflow_1_1models_1_1Model.html#ae28738d404dc06dad226edf42334f562">evaluate</a>: output <code>loss</code> given <code>X</code> and <code>Target</code></li>
<li><a class="el" href="classkeraflow_1_1models_1_1Model.html#ab13683e3a5dab8c274adea05d6736704">predict</a>: output <code>Y</code> given <code>X</code></li>
</ul>
<p>Both <code>fit</code> and <code>evaluate</code> takes <code>X</code> and <code>Target</code> as inputs. As for <code>predict</code>, only <code>X</code> is required.</p>
<p>For <b>Sequential</b> (single input, single output), <code>X</code>, <code>Target</code> takes a single numpy array (or list). For <b>Model</b>, <code>X</code>, <code>Target</code> takes a dictionary/list of numpy array(s) (see <a class="el" href="md_Tutorials.html#argument_passing_summarization">Argument Passing Summarization</a>).</p>
<h2><a class="anchor" id="model_serialization"></a>
Model Serialization</h2>
<p>You could save a (trained) model to disk and restore it for later use. Simply run </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;model.save_to_file(arch_fname=<span class="stringliteral">&#39;arch.json&#39;</span>, weight_fname=<span class="stringliteral">&#39;weight.pkl&#39;</span>, indent=2)</div>
</div><!-- fragment --><p>Note that the architecture and the model parameters are stored separately. If you don't want to save model weights, set <code>weight_fname</code> to <code>None</code>.</p>
<p>Keraflow supports two file formats for storing model architectue: <code>json</code> and <code>yaml</code>. Please specify the file extension to switch between these two formats. Note that in addition to <code>arch_fname</code> and <code>weight_fname</code>, <code>save_to_file</code> takes <code>**kwargs</code> and pass them to <code>json.dump</code> or <code>yaml.dump</code>. So, in the above example, the <code>indent</code> argument is to beautify the architecture output.</p>
<h1><a class="anchor" id="argument_passing_summarization"></a>
Argument Passing Summarization</h1>
<p>To bring both flexibly and convince to argument passing in Keraflow, for some arguments of some functions, users can pass a single value, a dictionary, or a list. We summarize them as follows. For more examples, please refer to <a class="el" href="md_Initializations.html#initialization-of-layer-parameters-by-weights">Initial Weights</a>, <a class="el" href="md_Regularizers.html">Regularizers</a>, and <a class="el" href="md_Constraints.html">Constraints</a>.</p>
<h2>Array-like data:</h2>
<p>Related arguments:</p>
<ol type="1">
<li><a class="el" href="classkeraflow_1_1layers_1_1base_1_1Layer.html#aa5f88487e05503f9488b35156c993c42">Layer.__init__</a>: <code>initial_weights</code></li>
<li><a class="el" href="classkeraflow_1_1models_1_1Model.html#aebe458039ef29e1d9b75ece6bdeec7b4">fit</a>, <a class="el" href="classkeraflow_1_1models_1_1Model.html#ab13683e3a5dab8c274adea05d6736704">predict</a>, <a class="el" href="classkeraflow_1_1models_1_1Model.html#ae28738d404dc06dad226edf42334f562">evaluate</a>: <code>x</code>, <code>y</code>, <code>sample_weights</code></li>
</ol>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment"># dict: accepts both array and list</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;initial_weights = {<span class="stringliteral">&#39;W&#39;</span>:numpy.array([[1,2],[3,4]]), <span class="stringliteral">&#39;b&#39;</span>: numpy.array([1,2])}</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;initial_weights = {<span class="stringliteral">&#39;W&#39;</span>:[[1,2],[3,4]], <span class="stringliteral">&#39;b&#39;</span>: [1,2]}</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"># list: accepts only array</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;initial_weights = [numpy.array([[1,2],[3,4]]), numpy.array([1,2])]</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"># single value: accepts both array or list </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;initial_weights = numpy.array([[1,2], [3,4]])</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;initial_weights = [[1,2], [3,4]]</div>
</div><!-- fragment --><h2>Function or str or Class instance</h2>
<p>Related arguments:</p>
<ol type="1">
<li><a class="el" href="classkeraflow_1_1layers_1_1base_1_1Layer.html#aa5f88487e05503f9488b35156c993c42">Layer.__init__</a>: <code>regularizers</code>, <code>constraints</code></li>
<li><a class="el" href="classkeraflow_1_1models_1_1Model.html#a1693672d05741f848e1a30f5c58bbbcd">compile</a>: <code>loss</code>, <code>metrics</code></li>
</ol>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment"># dict: accepts functions/str/class instance</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;metrics = {<span class="stringliteral">&#39;output1&#39;</span>: metrics.accuracy}</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;loss = {<span class="stringliteral">&#39;output1&#39;</span>: <span class="stringliteral">&#39;mse&#39;</span>, <span class="stringliteral">&#39;output2&#39;</span>:<span class="stringliteral">&#39;mae&#39;</span>}</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;regularizers = {<span class="stringliteral">&#39;W&#39;</span>: regularizers.L1(0.5), <span class="stringliteral">&#39;b&#39;</span>: regularizers.L2(0.1)}</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"># list: accepts functions/str/class instance</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;metrics = [metrics.accuracy]</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;loss = [<span class="stringliteral">&#39;mse&#39;</span>, <span class="stringliteral">&#39;mae&#39;</span>]</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;regularizers = [regularizers.L1(0.5), regularizers.L2(0.1)]</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"># single value: Only loss accepts single value, if there is only a single output.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;loss = <span class="stringliteral">&#39;categorical_crossentropy&#39;</span></div>
</div><!-- fragment --><h2>Rules for Missing values:</h2>
<p>Related arguments:</p>
<ol type="1">
<li><a class="el" href="classkeraflow_1_1layers_1_1base_1_1Layer.html#aa5f88487e05503f9488b35156c993c42">Layer.__init__</a>: <code>initial_weights</code>, <code>regularizers</code>, <code>constraints</code></li>
<li><a class="el" href="classkeraflow_1_1models_1_1Model.html#aebe458039ef29e1d9b75ece6bdeec7b4">fit</a>, <a class="el" href="classkeraflow_1_1models_1_1Model.html#ab13683e3a5dab8c274adea05d6736704">predict</a>, <a class="el" href="classkeraflow_1_1models_1_1Model.html#ae28738d404dc06dad226edf42334f562">evaluate</a>: <code>sample_weights</code></li>
<li><a class="el" href="classkeraflow_1_1models_1_1Model.html#a1693672d05741f848e1a30f5c58bbbcd">compile</a>: <code>metrics</code></li>
</ol>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment"># dict: specify only the used key</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;initial_weights = {<span class="stringliteral">&#39;W&#39;</span>:[[1,2],[3,4]]}</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"># list: first  come first serves</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;initial_weights = [numpy.array([[1,2],[3,4]])] <span class="comment"># sets only W&#39;s weights</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"># single value: first come first serves </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"># useful when there is only one parameter/input layer/output layer</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;initial_weights = [[1,2],[3,4]] <span class="comment"># sets only W&#39;s weights</span></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Sep 5 2016 15:54:50 for Keraflow by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
